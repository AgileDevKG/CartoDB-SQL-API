update error messages if a query goes wrong
add locking cache as per tilelive-mapnik to the queries

one day
-------
move to fully chunked row by row evented pg model (maybe)
